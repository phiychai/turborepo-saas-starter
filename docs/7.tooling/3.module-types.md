---
title: 'Module Types'
description: 'Module system and type definitions'
navigation:
  title: 'Module Types'
  order: 3
---

## Overview

This document explains the module system configuration across the monorepo and when to use `.js`, `.cjs`, or `.mjs` file extensions.

> **Note**: For configuration files specifically, see [Configuration Files](./2.config-files) for a quick reference.

## Package Types

### ES Modules (`"type": "module"`)

The following packages are configured as ES modules:

- ✅ `apps/web/` (Nuxt)
- ✅ `apps/backend/` (AdonisJS)

**File Extension Rules:**
- `.js` files are treated as **ES modules** (use `import`/`export`)
- `.cjs` files are **CommonJS** (use `require()`/`module.exports`)
- `.mjs` files are **ES modules** (explicit)

### CommonJS (default)

The following packages use CommonJS by default:

- ✅ Root workspace
- ✅ `tools/eslint-config/`
- ✅ `packages/shared-config/`

**File Extension Rules:**
- `.js` files are treated as **CommonJS** (use `require()`/`module.exports`)
- `.mjs` files are **ES modules** (use `import`/`export`)
- `.cjs` files are **CommonJS** (explicit)

## Configuration Files

### ESLint Configurations

| App                       | File                | Type      | Why                                                   |
| ------------------------- | ------------------- | --------- | ----------------------------------------------------- |
| `apps/web/`               | `eslint.config.mjs` | ES Module | Nuxt uses ESM, imports from `.nuxt/`                  |
| `apps/backend/`           | `eslint.config.js`  | CommonJS  | Uses `require()`, needs to be `.cjs` OR switch to ESM |
| `packages/eslint-config/` | `*.js`              | CommonJS  | Package is CommonJS by default                        |

### Prettier Configurations

| App                       | File                  | Type     | Why                                         |
| ------------------------- | --------------------- | -------- | ------------------------------------------- |
| `apps/web/`               | `prettier.config.cjs` | CommonJS | Package is ESM, but config uses `require()` |
| `apps/backend/`           | `prettier.config.cjs` | CommonJS | Package is ESM, but config uses `require()` |
| Root                      | `.prettierrc.js`      | CommonJS | Root is CommonJS by default                 |
| `packages/eslint-config/` | `prettier.config.js`  | CommonJS | Package is CommonJS by default              |

## Quick Reference

### When to use `.cjs`

Use `.cjs` when:
1. Your `package.json` has `"type": "module"`, AND
2. Your file uses CommonJS syntax (`require()`, `module.exports`)

**Example:**
```javascript
// apps/web/prettier.config.cjs
module.exports = require('@app-platform/eslint-config/prettier.config.js');
```

### When to use `.mjs`

Use `.mjs` when:
1. Your `package.json` does NOT have `"type": "module"`, AND
2. Your file uses ES module syntax (`import`, `export`)

**Example:**
```javascript
// some-config.mjs
import { defineConfig } from 'some-tool';
export default defineConfig({});
```

### When to use `.js`

Use `.js` when:
1. Your file matches the package's default type (ESM or CommonJS)

## TypeScript Files

TypeScript files (`.ts`, `.tsx`) are not affected by the `"type"` field:
- Always use `import`/`export` syntax
- TypeScript compiler handles the transformation

## Common Issues

### ❌ Error: `require() of ES Module`

**Problem:** Using `require()` in a `.js` file when package has `"type": "module"`

**Solution:** Rename file to `.cjs` or convert to ES module syntax

### ❌ Error: `Cannot use import statement outside a module`

**Problem:** Using `import` in a `.js` file when package is CommonJS

**Solution:** Rename file to `.mjs` or add `"type": "module"` to package.json

### ❌ Error: `ERR_PACKAGE_PATH_NOT_EXPORTED`

**Problem:** Package doesn't export the file you're trying to import

**Solution:** Check the `exports` field in the package's `package.json`

## Best Practices

1. **Consistency:** Keep the same module system within a package
2. **Explicit extensions:** Use `.cjs` or `.mjs` when mixing module types
3. **Config files:** Prefer explicit extensions (`.cjs`, `.mjs`) for config files
4. **Documentation:** Document which module system each package uses

## Migration Guide

### Converting from CommonJS to ESM

If you want to convert a package from CommonJS to ESM:

1. Add `"type": "module"` to `package.json`
2. Change all `require()` to `import`
3. Change all `module.exports` to `export` or `export default`
4. Rename any remaining CommonJS files to `.cjs`
5. Update file extensions in imports (include `.js`)

### Converting from ESM to CommonJS

If you want to convert a package from ESM to CommonJS:

1. Remove `"type": "module"` from `package.json`
2. Change all `import` to `require()`
3. Change all `export` to `module.exports`
4. Rename any remaining ES module files to `.mjs`

## Summary

| Package                   | Default Type | .js means | Use .cjs for | Use .mjs for |
| ------------------------- | ------------ | --------- | ------------ | ------------ |
| `apps/web/`               | ESM          | ES Module | CommonJS     | -            |
| `apps/backend/`           | ESM          | ES Module | CommonJS     | -            |
| `packages/eslint-config/` | CommonJS     | CommonJS  | -            | ES Module    |
| Root                      | CommonJS     | CommonJS  | -            | ES Module    |

